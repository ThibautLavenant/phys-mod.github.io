
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercices</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/simu_gw.jpg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-informations-generales.html">
   Informations générales
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-pedagogie.html">
     Pédagogie
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-competences.html">
     Objectifs d’apprentissage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-deroulement.html">
     Déroulement du cours
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-evaluation.html">
     Évaluations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-outils-numeriques.html">
     Outils numériques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-licence.html">
     Crédits et licence
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-python-base.html">
   Python base
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/01-prise-en-main.html">
     Première prise en main
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/02-listes-python.html">
     Les listes Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/03-fonctions-modules.html">
     Fonctions et modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/04-module-numpy.html">
     Le module NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/05-fonctions-numpy.html">
     Les fonctions de Numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/06-module-matplotlib.html">
     Le module Matplotlib
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-python-intermediaire.html">
   Python intermédiaire
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/01-dictionnaires-pandas.html">
     Dictionnaires et Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/02-logique-filtrage.html">
     Logique, structures de contrôle et filtrage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/01-iteration.html">
     Itération
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/02-fonctions.html">
     Fonctions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01-entrees-sorties.html">
     Entrées-sorties
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-modelisation-numerique.html">
   Modélisation numérique
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/03-acceleration-constante.html">
     Modèle de l’accélération constante
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/03-suite-graphique.html">
     Représentation graphique d’une suite mathématique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02-ajustement-modele.html">
     Ajuster un modèle aux données
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-derivation-integration/01-derivation-integration-cours.html">
     Dérivation et intégration numérique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-equations-differentielles/01-equations-differentielles-cours.html">
     Équations différentielles ordinaires (EDO)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-exercices.html">
   Exercices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/04-exercices.html">
     Démarche de modélisation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-mini-projets.html">
   Mini-projets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/05-retrogradation-mars.html">
     Mouvement rétrograde de Mars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/05-mini-projet-logistique.html">
     Un exemple de système chaotique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-mini-projet-rechauffement-climatique.html">
     Le réchauffement climatique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-derivation-integration/03-mini-projet-digue.html">
     Calcul des forces de pression sur une digue
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-equations-differentielles/03-mini-projet-pendule.html">
     Le pendule
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pages/part-projet.html">
   Description du projet
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/source/notebooks/04-ajustement-modele/03-exercices.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/source/notebooks/04-ajustement-modele/03-exercices.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chute-libre">
   Chute libre
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correction">
     Correction
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loi-de-puissance">
   Loi de puissance
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Correction
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decroissance-exponentielle">
   Décroissance exponentielle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Correction
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Exercices</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chute-libre">
   Chute libre
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correction">
     Correction
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loi-de-puissance">
   Loi de puissance
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Correction
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decroissance-exponentielle">
   Décroissance exponentielle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Correction
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="exercices">
<h1>Exercices<a class="headerlink" href="#exercices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="chute-libre">
<h2>Chute libre<a class="headerlink" href="#chute-libre" title="Permalink to this headline">¶</a></h2>
<p>Des étudiants ont effectué une expérience de chute libre : ils ont fait tomber un objet de chaque étage de l’Atrium, sans vitesse initiale, et ont mesuré à chaque fois le temps de chute <span class="math notranslate nohighlight">\(T\)</span> de l’objet ainsi que la hauteur de l’étage <span class="math notranslate nohighlight">\(H\)</span>. On reporte dans le tableau ci-dessous le résultat des mesures pour 4 groupes différents.</p>
<p><img alt="data chute libre" src="../../../_images/table_analyse_chute.png" /></p>
<p>Nous savons que l’objet chute sous l’effet de la pesanteur. Nous voulons grâce à cette expérience déterminer la magnitude de la pesanteur. Pour cela, nous utilisons un modèle simple du temps de chute libre. On montre facilement d’après la loi fondamentale de la dynamique, si on néglige les frottements de l’air, le lien entre la hauteur de l’étage <span class="math notranslate nohighlight">\(H\)</span>, le temps de chute <span class="math notranslate nohighlight">\(T\)</span>, et la magnitude de la pesanteur <span class="math notranslate nohighlight">\(g\)</span> :</p>
<div class="math notranslate nohighlight">
\[
H = g\times\dfrac{T^2}{2}
\]</div>
<ol class="simple">
<li><p>Identifier dans cette équation  le(s) donnée(s) de l’expérience et le(s) paramètre(s) du modèle. Écrire les données sous la forme de tableaux numpy.</p></li>
<li><p>Écrire le modèle sous la forme d’une fonction python à ajuster, de la forme <span class="math notranslate nohighlight">\(y(x;a)=ax\)</span>.</p></li>
<li><p>Déterminer la valeur de <span class="math notranslate nohighlight">\(g\)</span> en ajustant les données du 1er groupe. Afficher à l’écran la valeur trouvée, et faire un graphique sur lequel on voit le modèle (en ligne continue) et les données (marqueurs). On veillera à légender et mettre des titres aux axes et au graphique.</p></li>
<li><p>Ajuster les données des 4 groupes grâce à une boucle, et calculer la valeur de <span class="math notranslate nohighlight">\(g\)</span> comme la moyenne des résultats des 4 groupes.</p></li>
</ol>
<div class="section" id="correction">
<h3>Correction<a class="headerlink" href="#correction" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">#1</span>
<span class="c1"># H et T sont les données de l&#39;expérience</span>
<span class="c1"># g est un paramètre du modèle</span>

<span class="c1"># Écriture des données dans un tableau numpy</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.09</span><span class="p">,</span>  <span class="mf">1.39</span><span class="p">,</span>  <span class="mf">1.70</span><span class="p">,</span>  <span class="mf">2.05</span><span class="p">,</span>  <span class="mf">2.25</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.17</span><span class="p">,</span>  <span class="mf">1.54</span><span class="p">,</span>  <span class="mf">1.72</span><span class="p">,</span>  <span class="mf">2.18</span><span class="p">,</span>  <span class="mf">2.40</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.33</span><span class="p">,</span>  <span class="mf">1.68</span><span class="p">,</span>  <span class="mf">1.56</span><span class="p">,</span>  <span class="mf">2.19</span><span class="p">,</span>  <span class="mf">2.40</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span>  <span class="mf">1.61</span><span class="p">,</span>  <span class="mf">1.49</span><span class="p">,</span>  <span class="mf">2.16</span><span class="p">,</span>  <span class="mf">2.18</span><span class="p">]])</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.40</span><span class="p">,</span>  <span class="mf">10.80</span><span class="p">,</span> <span class="mf">14.20</span><span class="p">,</span> <span class="mf">17.60</span><span class="p">,</span> <span class="mf">20.95</span><span class="p">])</span>

<span class="c1">#2</span>
<span class="c1"># Modèle</span>
<span class="k">def</span> <span class="nf">chute</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span>

<span class="c1">#3</span>
<span class="c1"># Ajustement des données du 1er groupe</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">H</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">params</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">chute</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c1"># Affichage de la valeur trouvée</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Groupe 1 :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  g = &quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot; m/s^2&quot;</span><span class="p">)</span>

<span class="c1"># Graphique</span>
<span class="n">xm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">chute</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Modèle&#39;</span><span class="p">,</span> <span class="s1">&#39;Données&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajustement des données du groupe 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T**2/2 [s**2]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;H [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#4</span>
<span class="c1"># Ajustement des données de tous les groupes</span>
<span class="n">Ng</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="c1"># Ajustement des données du ième groupe</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">H</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">params</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">chute</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="c1"># Affichage de la valeur trouvée</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Groupe&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  g =&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;m/s^2&quot;</span><span class="p">)</span>
    <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Graphique</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">chute</span><span class="p">(</span><span class="n">xm</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Groupe &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, modèle&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Groupe &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, expérience&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajustement des données du groupe 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;T**2/2 [s**2]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;H [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># Affichage de la valeur moyenne</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valeur Moyenne :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  g =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Groupe 1 :
  g =  8.830251326645204  m/s^2
</pre></div>
</div>
<img alt="../../../_images/03-exercices_3_1.png" src="../../../_images/03-exercices_3_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Groupe 1 :
  g = 8.830251326645204 m/s^2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Groupe 2 :
  g = 7.833725959694802 m/s^2
Groupe 3 :
  g = 7.738300675460513 m/s^2
Groupe 4 :
  g = 8.725650823609033 m/s^2
</pre></div>
</div>
<img alt="../../../_images/03-exercices_3_4.png" src="../../../_images/03-exercices_3_4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Valeur Moyenne :
  g = 8.281982196352388
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="loi-de-puissance">
<h2>Loi de puissance<a class="headerlink" href="#loi-de-puissance" title="Permalink to this headline">¶</a></h2>
<p>On va travailler sur les données des exoplanètes. Le but de l’exercice consiste à déterminer si les données expérimentales peuvent être ajustées par la fonction correspondant à la 3ème loi de Kepler.</p>
<ol class="simple">
<li><p>Charger les données des exoplanètes du fichier <code class="docutils literal notranslate"><span class="pre">exoplanets.dat</span></code> et representer <span class="math notranslate nohighlight">\(\log(R)\)</span> en fonction de <span class="math notranslate nohighlight">\(\log(T)\)</span></p></li>
<li><p>Expliquer pourquoi la représentation graphique logarithmique est mieux adaptée que la représentation graphique linéaire.</p></li>
<li><p>Montrer également (par le calcul) qu’il est possible de faire une régression linéaire en utilisant la représentation mathématique logarithmique pour ajuster la 3ème loi de Kepler.</p></li>
<li><p>Effectuer la régression linéaire sur la troisième loi de Kepler, et comparer la valeur théorique du rapport des exposants <span class="math notranslate nohighlight">\(3/2\)</span> à la valeur expérimentale.</p></li>
</ol>
<div class="section" id="id1">
<h3>Correction<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1</span>
<span class="c1"># Importation des librairies</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Constantes</span>
<span class="n">au</span> <span class="o">=</span> <span class="mf">149597870700.0</span>
<span class="n">jour</span> <span class="o">=</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>

<span class="c1"># Chargement et conversion des données</span>
<span class="n">d_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./exoplanets.dat&#39;</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">d_exp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">au</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">d_exp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">jour</span>

<span class="c1"># Affichage des données</span>
<span class="n">lR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="n">lT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lR</span><span class="p">,</span> <span class="n">lT</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\log(R)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$\log(T)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/03-exercices_6_0.png" src="../../../_images/03-exercices_6_0.png" />
</div>
</div>
<p><strong>Question 2</strong>
L’échelle logarithmique permet de voir toutes les données dispersées sur plusieurs ordres de grandeur.</p>
<p><strong>Question 3</strong>
De plus, si <span class="math notranslate nohighlight">\(T^2 = K R^3\)</span>, alors <span class="math notranslate nohighlight">\(\log(T) = \frac{3}{2} \log(R) + \frac{1}{2} \log(K)\)</span></p>
<p>==&gt; On peut également tester la relation de proportionalité <em>via</em> un ajustement affine des distributions logarithmiques. On attend alors une pente de <span class="math notranslate nohighlight">\(1.5\)</span> et une ordonnée à l’origine égale à <span class="math notranslate nohighlight">\(0.5\mathrm{log}(K)\)</span>.</p>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 4</span>

<span class="c1"># Modèle</span>
<span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Loi linéaire &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1"># Ajustement linéaire avec la fonction `line`</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">lR</span><span class="p">,</span> <span class="n">lT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Affichage des résultats</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a =&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="s1">&#39;; b = &#39;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;K =&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="s2">&quot;s^2/m^3&quot;</span><span class="p">)</span>

<span class="c1"># Calcul du modèle</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lR</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">lR</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1"># Affichage graphique des résultats</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lR</span><span class="p">,</span> <span class="n">lT</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajustement du modèle aux données&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$\log(R)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$\log(T)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a = 1.4984474486443866 ; b =  -21.332684269056813
K = 2.9557375947792144e-19 s^2/m^3
</pre></div>
</div>
<img alt="../../../_images/03-exercices_8_1.png" src="../../../_images/03-exercices_8_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="decroissance-exponentielle">
<h2>Décroissance exponentielle<a class="headerlink" href="#decroissance-exponentielle" title="Permalink to this headline">¶</a></h2>
<p>On va ici tenter de modéliser la vitesse de décroissance de l’épaisseur de mousse de bière. On reprendra pour cela les données présentées par Arnd Leike, chercheur à l’Université Ludwig Maximilians de Munich, dans une publication  qui lui a valu le prix Ig Nobel en 2002.</p>
<p>Récupérer les données présentées dans le tableau 1 de la <a class="reference external" href="https://www.tf.uni-kiel.de/matwis/amat/iss/kap_2/articles/beer_article.pdf">publication disponible ici</a>.</p>
<ol class="simple">
<li><p>Représentez le logarithme décimal de l’épaisseur de mousse de la Augustinerbräu en fonction du temps : <span class="math notranslate nohighlight">\(\log_{10}(h) = f(t)\)</span>.</p></li>
<li><p>Effectuez l’ajustement qui vous semble le plus approprié, et en déduire le modèle de décroissance auquel cet ajustement correspond. Déterminez le  temps caractéristique de la décroissance.</p></li>
<li><p>Effectuez un ajustement exponentiel de la fonction <span class="math notranslate nohighlight">\(h(t)\)</span> (cf résultat ci-dessous), et comparez vos résultats à ceux de la question précédente.</p></li>
<li><p>Le taux de désintégration d’un matériau radioactif suit également une loi exponentielle. Peut-on trouver une analogie avec l’épaisseur de la mousse de bière  ?</p></li>
</ol>
<p>Dans le tableau 1 de l’article de Leike, l’auteur a également associé des incertitudes aux mesures d’épaisseur de mousses.</p>
<ol class="simple">
<li><p>Représentez ces incertitudes graphiquement en utilisant la fonction <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> de matplotlib.</p></li>
<li><p>Reprendre la question 3 en passant les erreurs <span class="math notranslate nohighlight">\(\sigma_{y_i}\)</span> dans le paramètre <em>sigma</em> de la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code>. On veillera à remplacer les valeurs d’incertitudes nulles par une valeur &gt; 0 pour permettre la convergence de l’ajustement (cf équation de la somme S pondérée dans le cours).</p></li>
</ol>
<p>On pourra remarquer qu’en plus des paramètres ajustés, un 2ème paramètre est retourné par la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code>. Il s’agit de la matrice de covariance de ces paramètres (que l’on peut noter <code class="docutils literal notranslate"><span class="pre">pcov</span></code>, dont on peut extraire l’incertitude sur chacun des paramètres, donnée par  <code class="docutils literal notranslate"><span class="pre">perr</span> <span class="pre">=</span> <span class="pre">np.sqrt(np.diag(pcov))</span></code>.</p>
<div class="section" id="id2">
<h3>Correction<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#1</span>

<span class="c1"># Données</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">14.0</span><span class="p">,</span> <span class="mf">11.8</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="mf">7.7</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">5.3</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span> <span class="c1"># cm</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">360</span><span class="p">])</span> <span class="c1"># s</span>
<span class="n">lh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

<span class="c1"># Affichage graphique des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lh</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\log(h)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/03-exercices_11_0.png" src="../../../_images/03-exercices_11_0.png" />
</div>
</div>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#2</span>

<span class="k">def</span> <span class="nf">modlin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Loi linéaire &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span>

<span class="c1"># Ajustement linéaire</span>
<span class="n">params</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">modlin</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">lh</span><span class="p">,</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Affichage des résultats</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(a, b) =&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tau =&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>

<span class="c1"># Calcul du modèle</span>
<span class="n">t_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">y_model</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t_model</span>

<span class="c1"># Affichage graphique des résultats</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lh</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_model</span><span class="p">,</span> <span class="n">y_model</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajustement linéaire du modèle aux données&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$t$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$\ln(h)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(a, b) = [ 2.65892185 -0.00758478]
tau = 131.84298472262253 s
</pre></div>
</div>
<img alt="../../../_images/03-exercices_12_1.png" src="../../../_images/03-exercices_12_1.png" />
</div>
</div>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#3</span>

<span class="k">def</span> <span class="nf">expLaw</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A0</span><span class="p">,</span> <span class="n">tau</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Loi exponentielle &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">A0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>

<span class="c1"># Ajustement exponentiel</span>
<span class="n">params</span><span class="p">,</span> <span class="n">covar</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">expLaw</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>

<span class="c1"># Affichage des résultats</span>
<span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tau =&quot;</span><span class="p">,</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>

<span class="c1"># Calcul du modèle</span>
<span class="n">t_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">y_model</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_model</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Affichage graphique des résultats</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_model</span><span class="p">,</span> <span class="n">y_model</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajustement exponentiel du modèle aux données&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$t~\mathrm{(s)}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$h~\mathrm{(cm)}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 13.23332627 147.9736446 ]
tau = 147.97364459633604 s
</pre></div>
</div>
<img alt="../../../_images/03-exercices_13_1.png" src="../../../_images/03-exercices_13_1.png" />
</div>
</div>
<p>On remarquera que l’ajustements linéaire de <span class="math notranslate nohighlight">\(\mathrm{log}(h)\)</span> et l’ajustement exponentiel de <span class="math notranslate nohighlight">\(h\)</span> produisent des valeurs différentes de la constante de temps <span class="math notranslate nohighlight">\(\tau\)</span> caractéristique de la décroissance définie par <span class="math notranslate nohighlight">\(y = A_0 e^{-\frac{t}{\tau}}\)</span> : <span class="math notranslate nohighlight">\(131 \mathrm{~s}\)</span> contre <span class="math notranslate nohighlight">\(148 \mathrm{~s}\)</span>.</p>
<p><strong>Question 4</strong></p>
<p>L’évolution des deux phénomènes est modélisée par un phénomène sans mémoire (la désintégration des noyaux radioactifs ou l’éclatement des bulles). La loi est donc exponentielle.</p>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#5</span>

<span class="n">dh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="c1"># Affichage graphique des données avec incertitudes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dh</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\log(h)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/03-exercices_16_0.png" src="../../../_images/03-exercices_16_0.png" />
</div>
</div>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#6</span>

<span class="c1"># Ajustement avec minimisation du chi2</span>
<span class="n">params</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">expLaw</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">dh</span><span class="p">)</span>
<span class="c1"># Récupération des incertitudes à partir de la matrice de covariance</span>
<span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>

<span class="c1"># Affichage des valeurs des paramètres et des incertitudes</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dtau</span> <span class="o">=</span> <span class="n">perr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a =&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="s1">&#39;+-&#39;</span><span class="p">,</span> <span class="n">da</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tau =&#39;</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;+-&#39;</span><span class="p">,</span> <span class="n">dtau</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="c1"># Calcul du modèle</span>
<span class="n">t_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">h_model</span> <span class="o">=</span> <span class="n">expLaw</span><span class="p">(</span><span class="n">t_model</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>

<span class="c1"># Représentation graphique du modèle et des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_model</span><span class="p">,</span> <span class="n">h_model</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ajustement exponentiel du modèle aux données</span><span class="se">\n</span><span class="s1">Minimisation du $\chi^2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$t~\mathrm{(s)}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$h~\mathrm{(cm)}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a = 13.999072208210503 +- 0.009806239483446897 cm
tau = 123.2378710599443 +- 5.384389252318669 s
</pre></div>
</div>
<img alt="../../../_images/03-exercices_17_1.png" src="../../../_images/03-exercices_17_1.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./source/notebooks/04-ajustement-modele"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By P. Delva<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>