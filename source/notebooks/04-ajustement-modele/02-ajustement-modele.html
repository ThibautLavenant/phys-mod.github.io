
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ajuster un modèle aux données</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Dérivation et intégration numérique" href="../05-derivation-integration/01-derivation-integration-cours.html" />
    <link rel="prev" title="Représentation graphique d’une suite mathématique" href="../03-suites-relations-recurrence/03-suite-graphique.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/simu_gw.jpg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-informations-generales.html">
   Informations générales
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-pedagogie.html">
     Pédagogie
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-competences.html">
     Objectifs d’apprentissage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-deroulement.html">
     Déroulement du cours
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-evaluation.html">
     Évaluations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-outils-numeriques.html">
     Outils numériques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../pages/info-licence.html">
     Crédits et licence
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-python-base.html">
   Python base
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/01-prise-en-main.html">
     Première prise en main
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/02-listes-python.html">
     Les listes Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/03-fonctions-modules.html">
     Fonctions et modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/04-module-numpy.html">
     Le module NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/05-fonctions-numpy.html">
     Les fonctions de Numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-python-base/06-module-matplotlib.html">
     Le module Matplotlib
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-python-intermediaire.html">
   Python intermédiaire
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/01-dictionnaires-pandas.html">
     Dictionnaires et Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/02-logique-filtrage.html">
     Logique, structures de contrôle et filtrage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/01-iteration.html">
     Itération
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/02-fonctions.html">
     Fonctions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="01-entrees-sorties.html">
     Entrées-sorties
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../pages/part-modelisation-numerique.html">
   Modélisation numérique
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/03-acceleration-constante.html">
     Modèle de l’accélération constante
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/03-suite-graphique.html">
     Représentation graphique d’une suite mathématique
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Ajuster un modèle aux données
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-derivation-integration/01-derivation-integration-cours.html">
     Dérivation et intégration numérique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-equations-differentielles/01-equations-differentielles-cours.html">
     Équations différentielles ordinaires (EDO)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pages/part-mini-projets.html">
   Mini-projets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-demarche-de-modelisation/05-retrogradation-mars.html">
     Mouvement rétrograde de Mars
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-suites-relations-recurrence/05-mini-projet-logistique.html">
     Un exemple de système chaotique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-mini-projet-rechauffement-climatique.html">
     Le réchauffement climatique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05-derivation-integration/03-mini-projet-digue.html">
     Calcul des forces de pression sur une digue
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06-equations-differentielles/03-mini-projet-pendule.html">
     Le pendule
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pages/part-projet.html">
   Description du projet
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/source/notebooks/04-ajustement-modele/02-ajustement-modele.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/source/notebooks/04-ajustement-modele/02-ajustement-modele.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametres-d-un-modele">
   Paramètres d’un modèle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercice">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-methode-des-moindres-carres">
   La méthode des moindres-carrés
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-lineaire">
   Régression linéaire
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-fonction-curve-fit">
   La fonction
   <code class="docutils literal notranslate">
    <span class="pre">
     curve_fit
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#erreurs-de-mesures">
   Erreurs de mesures
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#erreurs-sur-les-parametres-ajustes">
   Erreurs sur les paramètres ajustés
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Ajuster un modèle aux données</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parametres-d-un-modele">
   Paramètres d’un modèle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercice">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-methode-des-moindres-carres">
   La méthode des moindres-carrés
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-lineaire">
   Régression linéaire
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-fonction-curve-fit">
   La fonction
   <code class="docutils literal notranslate">
    <span class="pre">
     curve_fit
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Exercice
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#erreurs-de-mesures">
   Erreurs de mesures
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#erreurs-sur-les-parametres-ajustes">
   Erreurs sur les paramètres ajustés
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="ajuster-un-modele-aux-donnees">
<h1>Ajuster un modèle aux données<a class="headerlink" href="#ajuster-un-modele-aux-donnees" title="Permalink to this headline">¶</a></h1>
<p>Nous avons vu jusqu’ici plusieurs exemples de modèles en physique, et leur représentation numérique. Ces modèles sont construits pour représenter des données expérimentales ou des observations.</p>
<p>Les modèles dépendent d’un certain nombre de paramètres qu’il faut choisir afin de représenter au mieux les données. Une méthode possible est d’utiliser les données expérimentales ou les observations afin de trouver le meilleur jeu de paramètres qui les représente à l’aide d’un modèle donné. On dit que l’on fait un <strong>ajustement du modèle aux données</strong>. En anglais on appelle cela un <em><strong>fit</strong></em>, terme qui est souvent repris par les physiciens, même en français.</p>
<p>Une méthode pour trouver le meilleur ajustement d’un modèle aux données est la méthode des moindres carrés, ce que nous allons voir ici.</p>
<div class="section" id="parametres-d-un-modele">
<h2>Paramètres d’un modèle<a class="headerlink" href="#parametres-d-un-modele" title="Permalink to this headline">¶</a></h2>
<p>Reprenons le modèle de l’accéleration constante vu dans la séquence sur la démarche de modélisation. Nous avons mesuré la vitesse <span class="math notranslate nohighlight">\(v_i\)</span> d’un objet pour des temps <span class="math notranslate nohighlight">\(t_i\)</span>. L’objet est lâché avec une vitesse initiale vers le bas d’environ 1,6 m/s. Voici le résultat des mesures :</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="head"><p>0</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t_i\)</span></p></td>
<td><p>0.0</p></td>
<td><p>0.1</p></td>
<td><p>0.2</p></td>
<td><p>0.3</p></td>
<td><p>0.4</p></td>
<td><p>0.5</p></td>
<td><p>0.6</p></td>
<td><p>0.7</p></td>
<td><p>0.8</p></td>
<td><p>0.9</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(v_i\)</span></p></td>
<td><p>0.338</p></td>
<td><p>-1.509</p></td>
<td><p>-5.301</p></td>
<td><p>-4.404</p></td>
<td><p>-6.967</p></td>
<td><p>-6.229</p></td>
<td><p>-5.279</p></td>
<td><p>-9.266</p></td>
<td><p>-8.847</p></td>
<td><p>-11.260</p></td>
<td><p>-12.040</p></td>
</tr>
</tbody>
</table>
<p>Le modèle est :</p>
<div class="math notranslate nohighlight">
\[
v(t;v_0,g) = v_0 - gt
\]</div>
<p>Nous déclarons que <span class="math notranslate nohighlight">\(v_0\)</span> et <span class="math notranslate nohighlight">\(g\)</span> sont les paramètres du modèle. Il est d’usage en physique de noter les paramètres après un point-virgule dans la fonction : <span class="math notranslate nohighlight">\(v(t;v_0,g)\)</span>, pour les distinguer de la variable libre <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Nous supposons que les paramètres du modèle, <span class="math notranslate nohighlight">\(v_0\)</span> et <span class="math notranslate nohighlight">\(g\)</span>, ne sont pas connus <em>a priori</em>. Nous allons utiliser les données expérimentales pour trouver les meilleures valeurs possibles des paramètres, d’après ces données.</p>
<p>Représentons graphiquement les données et le modèle :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importation des modules</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Données experimentales</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">t_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">v_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.338</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.509</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.301</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.404</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.967</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.229</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.279</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.266</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.847</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.260</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.040</span><span class="p">])</span>

<span class="c1"># Paramètres du modèle</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Discrétisation du modèle</span>
<span class="n">t_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">v_mod</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">-</span> <span class="n">g</span> <span class="o">*</span> <span class="n">t_exp</span>

<span class="c1"># Représentation graphique du modèle et des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="s1">&#39;+k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_mod</span><span class="p">,</span> <span class="n">v_mod</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/02-ajustement-modele_4_0.png" src="../../../_images/02-ajustement-modele_4_0.png" />
</div>
</div>
<div class="section" id="exercice">
<h3>Exercice<a class="headerlink" href="#exercice" title="Permalink to this headline">¶</a></h3>
<p>Ajuster la valeur des paramètres <span class="math notranslate nohighlight">\(v_0\)</span> et <span class="math notranslate nohighlight">\(g\)</span> <em>à la main</em>, c’est-à-dire en changeant directement leur valeur dans le script ci-dessus, afin que le modèle représente au mieux les données.</p>
<p>Quel est le critère qui vous permet de dire que le modèle représente mieux les données ?</p>
</div>
</div>
<div class="section" id="la-methode-des-moindres-carres">
<h2>La méthode des moindres-carrés<a class="headerlink" href="#la-methode-des-moindres-carres" title="Permalink to this headline">¶</a></h2>
<p>La méthode des moindres carrés permet d’utiliser un critère quantitatif afin de trouver le meilleur ajustement d’un modèle d’après des données expérimentales. Calculons la somme quadratique des écarts entre le modèle et les données du problème :</p>
<div class="math notranslate nohighlight">
\[
S = \sum_{i=0}^{N-1} (y_i - P(x_i))^2 
\]</div>
<p>Les couples <span class="math notranslate nohighlight">\((x_i,y_i)\)</span> sont les données expérimentales, alors que <span class="math notranslate nohighlight">\(y=P(x)\)</span> est le modèle. Le but pour trouver le modèle le mieux ajusté aux données expérimentales est de minimiser la somme <span class="math notranslate nohighlight">\(S\)</span>. On minimise les carrés des écarts, d’où le nom de la méthode des « moindres carrés ».</p>
<p>Si on applique cela au problème de l’accélération constante, on a :</p>
<div class="math notranslate nohighlight">
\[
S(v_0,g) = \sum_{i=0}^{N-1} (v_i - (v_0 - g t_i))^2 
\]</div>
<p><span class="math notranslate nohighlight">\(S\)</span> est une fonction des paramètres du problème, qui doit avoir un minimum pour le meilleur ajustement du modèle aux données (<em>best fit</em> en anglais).</p>
<p>Représentons graphiquement cette somme :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Paramètres du modèle</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Discrétisation du modèle</span>
<span class="n">t_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">v_mod</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">-</span> <span class="n">g</span> <span class="o">*</span> <span class="n">t_exp</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v_mod</span><span class="p">)</span>

<span class="c1"># Calcul de la somme S</span>
<span class="n">Si</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_exp</span> <span class="o">-</span> <span class="n">v_mod</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Si</span><span class="p">)</span>

<span class="c1"># Représentation graphique du modèle et des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="s1">&#39;+k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_mod</span><span class="p">,</span> <span class="n">v_mod</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>

<span class="c1"># représentation des écarts entre le modèle et les données</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">t_exp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">t_exp</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="p">(</span><span class="n">v_exp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">v_mod</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s1">&#39;-r&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;S = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.  -0.5 -1.  -1.5 -2.  -2.5 -3.  -3.5 -4.  -4.5 -5. ]
</pre></div>
</div>
<img alt="../../../_images/02-ajustement-modele_8_1.png" src="../../../_images/02-ajustement-modele_8_1.png" />
</div>
</div>
<div class="section" id="id1">
<h3>Exercice<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Dans la cellule ci-dessus, calculer <span class="math notranslate nohighlight">\(S\)</span> pour les paramètres trouvés à l’exercice précedent. Pouvez-vous améliorer la valeur des paramètres en vous basant sur la valeur de <span class="math notranslate nohighlight">\(S\)</span> ?</p>
<p>Pourquoi les éléments de la somme des écarts entre les données et le modèle sont-ils mis au carré ?</p>
</div>
</div>
<div class="section" id="regression-lineaire">
<h2>Régression linéaire<a class="headerlink" href="#regression-lineaire" title="Permalink to this headline">¶</a></h2>
<p>Pour un modèle linéaire tel que celui de l’accélération constante, il est possible de trouver le minimum de la fonction <span class="math notranslate nohighlight">\(S\)</span> de façon analytique.</p>
<p>Le modèle linéaire est de la forme <span class="math notranslate nohighlight">\(P(x; a, b) = a + b x\)</span>. La somme <span class="math notranslate nohighlight">\(S\)</span> s’écrit alors</p>
<div class="math notranslate nohighlight">
\[
S(a,b) = \sum_{i=0}^{N-1} [y_i - (a + b x_i)]^2
\]</div>
<p>Le polynôme <span class="math notranslate nohighlight">\(S\)</span> obtenu est du second degré en <span class="math notranslate nohighlight">\(a\)</span> et <span class="math notranslate nohighlight">\(b\)</span>. Il peut s’écrire</p>
<div class="math notranslate nohighlight">
\[
S(a,b) = b^2 \sum_{i=0}^{N-1} x_i^2 + 2 a b \sum_{i=0}^{N-1} x_i + N a^2 - 2 b \sum_{i=0}^{N-1} x_i y_i - 2 a \sum_{i=0}^{N-1} y_i + \sum_{i=0}^{N-1} y_i^2
\]</div>
<p>Une condition nécessaire pour que <span class="math notranslate nohighlight">\(S\)</span> ait un minimum en <span class="math notranslate nohighlight">\((a_m,b_m)\)</span> est que le gradient de <span class="math notranslate nohighlight">\(S\)</span> s’annule au point <span class="math notranslate nohighlight">\((a_m,b_m)\)</span> :</p>
<p>\begin{eqnarray*}
\frac{\partial S}{\partial a} (a_m,b_m) &amp; = &amp; 0 ;;;; \Rightarrow ;;;; N a_m + b_m \sum_{i=0}^{N-1} x_i = \sum_{i=0}^{N-1} y_i\
\frac{\partial S}{\partial b} (a_m,b_m) &amp; = &amp; 0 ;;;; \Rightarrow ;;;; a_m \sum_{i=0}^{N-1} x_i + b_m \sum_{i=0}^{N-1} x_i^2 = \sum_{i=0}^{N-1} x_i y_i
\end{eqnarray*}</p>
<p>On obtient alors :</p>
<p>\begin{eqnarray*}
a_m &amp;=&amp; \bar{y}-b_m \bar{x}\
b_m &amp;=&amp; \frac{\mathrm{cov}(x,y)}{\mathrm{var}(x)}
\end{eqnarray*}</p>
<p>où</p>
<p>\begin{eqnarray*}
&amp; \bar{x} = \frac{1}{N} \sum_{i=0}^{N-1} x_{i} \
&amp; \bar{y} = \frac{1}{N} \sum_{i=0}^{N-1} y_{i} \
&amp; \mathrm{cov}(x,y) = \frac{1}{N} \sum_{i=0}^{N-1} (x_{i} - \bar{x}) (y_{i} - \bar{y_i}) = \left( \frac{1}{N} \sum_{i=0}^{N-1} x_{i} y_{i} \right) - \bar{x}\bar{y} \
&amp; \mathrm{var}(x) = \frac{1}{N} \sum_{i=0}^{N-1} (x_{i} - \bar{x})^2 = \left( \frac{1}{N} \sum_{i=0}^{N-1} x_{i}^2 \right) - \bar{x}^2
\end{eqnarray*}</p>
<p>La fonction suivante renvoie les paramètres <span class="math notranslate nohighlight">\(a\)</span> et <span class="math notranslate nohighlight">\(b\)</span> de la régression linéaire pour un jeu de données expérimentales :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fonction régression linéaire</span>
<span class="k">def</span> <span class="nf">reglin</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calcule les paramètres a et b du meilleur ajustement d&#39;un modèle linéaire</span>
<span class="sd">        y = ax + b sur un jeu de données (xi, yi)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
    
    <span class="n">xm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
    <span class="n">ym</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
    <span class="n">cov</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xi</span> <span class="o">*</span> <span class="n">yi</span><span class="p">)</span> <span class="o">-</span> <span class="n">xm</span> <span class="o">*</span> <span class="n">ym</span>
    <span class="n">var</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xi</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">xm</span> <span class="o">**</span> <span class="mi">2</span>
    
    <span class="n">b</span> <span class="o">=</span> <span class="n">cov</span> <span class="o">/</span> <span class="n">var</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">ym</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">xm</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Exercice<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Faire une régression linéaire sur les données temps, vitesse : <span class="math notranslate nohighlight">\((t_{\mathrm{exp}},v_{\mathrm{exp}})\)</span> en utilisant la fonction <code class="docutils literal notranslate"><span class="pre">reglin()</span></code>.</p></li>
<li><p>Comparer le résultat obtenu avec les valeurs des paramètres trouvés « à la main » dans l’exercice précédent.</p></li>
<li><p>Calculer <span class="math notranslate nohighlight">\(S\)</span> et le comparer à celui obtenu à l’exercice précédent</p></li>
<li><p>Tracer les données et le modèle trouvé avec la régression linéaire</p></li>
</ol>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Régression linéaire</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">reglin</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">)</span>

<span class="c1"># Paramètre du modèle </span>
<span class="c1"># y(x) = a + bx</span>
<span class="c1"># v(t) = v0 - gt</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span>

<span class="c1"># Affichage du résultat</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v0 = </span><span class="si">{:4.2f}</span><span class="s1"> m.s**-1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g = </span><span class="si">{:4.2f}</span><span class="s1"> m.s**-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>

<span class="c1"># Calcul du modèle</span>
<span class="n">t_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">v_mod</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">-</span> <span class="n">g</span> <span class="o">*</span> <span class="n">t_mod</span>

<span class="c1"># Calcul de la somme S</span>
<span class="n">Si</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_exp</span> <span class="o">-</span> <span class="p">(</span><span class="n">v0</span> <span class="o">-</span> <span class="n">g</span> <span class="o">*</span> <span class="n">t_exp</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Si</span><span class="p">)</span>

<span class="c1"># Représentation graphique du modèle et des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="s1">&#39;+k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_mod</span><span class="p">,</span> <span class="n">v_mod</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;S = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v0 = -1.00 m.s**-1
g = 10.87 m.s**-2
</pre></div>
</div>
<img alt="../../../_images/02-ajustement-modele_13_1.png" src="../../../_images/02-ajustement-modele_13_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="la-fonction-curve-fit">
<h2>La fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code><a class="headerlink" href="#la-fonction-curve-fit" title="Permalink to this headline">¶</a></h2>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> du module <code class="docutils literal notranslate"><span class="pre">optimize</span></code> de <code class="docutils literal notranslate"><span class="pre">scipy</span></code> permet d’ajuster n’importe quel modèle à des données expérimentales.</p>
<p>Voyons comment elle fonctionne avec les données de vitesse. Il faut d’abord définir la fonction python qui représente le modèle :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">modlin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Fonction qui représente le modèle linéaire</span>
<span class="sd">        y(x; a, b) = a + bx</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-warning">
<p><strong>Attention</strong></p>
<p>Dans la fonction python qui représente le modèle, il faut absolument que <strong>la variable libre soit le premier argument</strong> de la fonction. Suivent ensuite les paramètres du problème.</p>
</div><p>Nous importons ensuite la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
</div>
</div>
<p>Les arguments de la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> sont :</p>
<ol class="simple">
<li><p>La fonction python qui représente le modèle</p></li>
<li><p>Le tableau qui représente les données <span class="math notranslate nohighlight">\(x_i\)</span></p></li>
<li><p>Le tableau qui représente les données <span class="math notranslate nohighlight">\(y_i\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ajustement du modèle linéaire</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">modlin</span><span class="p">,</span> <span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">])</span>

<span class="c1"># Identification des paramètres du modèle</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span>

<span class="c1"># Affichage du résultat</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v0 = </span><span class="si">{:4.2f}</span><span class="s1"> m.s**-1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g = </span><span class="si">{:4.2f}</span><span class="s1"> m.s**-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>

<span class="c1"># Calcul du modèle</span>
<span class="n">t_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">v_mod</span> <span class="o">=</span> <span class="n">modlin</span><span class="p">(</span><span class="n">t_mod</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="c1"># Calcul de la somme S</span>
<span class="n">Si</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_exp</span> <span class="o">-</span> <span class="n">v_mod</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Si</span><span class="p">)</span>

<span class="c1"># Représentation graphique du modèle et des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="s1">&#39;+k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_mod</span><span class="p">,</span> <span class="n">v_mod</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;S = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v0 = -1.00 m.s**-1
g = 10.87 m.s**-2
</pre></div>
</div>
<img alt="../../../_images/02-ajustement-modele_21_1.png" src="../../../_images/02-ajustement-modele_21_1.png" />
</div>
</div>
<p>On voit que l’on obtient le même résultat qu’avec la régression linéaire. Ce ne sont pourtant pas les mêmes méthodes numériques qui sont employées. En augmentant le nombre de chiffres après la virgule utilisés pour afficher les paramètres trouvés avec chaque méthode, vous verrez que les résultats finissent par différer. On appelle cela la précision numérique de la méthode numérique. On le voit aussi sur les sommes <span class="math notranslate nohighlight">\(S\)</span> qui sont différentes, certes pas de beaucoup !</p>
<div class="alert alert-warning">
<p><strong>Attention</strong></p>
<p>La fonction <code class="docutils literal notranslate"><span class="pre">curve_fit()</span></code> utilise des valeurs de départ par défaut égales à 1 pour tous les paramètres, avant d’ajuster ces valeurs grâce à un algorithme que l’on ne verra pas dans ce cours. Il arrive parfois que la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit()</span></code> ne trouve pas de solution car les valeurs de départ des paramètres sont trop éloignées de la solution. Il faut alors utiliser l’option <code class="docutils literal notranslate"><span class="pre">p0</span></code> de la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit()</span></code>, où il faut spécifier le tableau des valeurs de départ voulues, qui soient plus approchées de la solution. Afin de connaître une valeur approximative de la solution, on peut comme dans le tout 1er exercice ajuster à la main les paramètres.</p>
</div><div class="section" id="id3">
<h3>Exercice<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Grâce à la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code>, on peut facilement changer de modèle. Définir un modèle quadratique de la forme <span class="math notranslate nohighlight">\(y(x;a,b,c) = a + bx + cx^2\)</span>, et ajuster les paramètres sur les données de vitesse. Calculer la somme <span class="math notranslate nohighlight">\(S\)</span> et représenter le modèle et les données.</p>
<div class="cell tag_solution docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">modquad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Fonction qui représente le modèle quadratique</span>
<span class="sd">        y(x; a,b,c) = a + bx + cx**2</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># Ajustement du modèle quadratique</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">modquad</span><span class="p">,</span> <span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">)</span>

<span class="c1"># Paramètres du modèle</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span>

<span class="c1"># Affichage du résultat</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v0 = </span><span class="si">{:4.2f}</span><span class="s1"> m.s**-1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g = </span><span class="si">{:4.2f}</span><span class="s1"> m.s**-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c = </span><span class="si">{:4.2f}</span><span class="s1"> m.s**-3&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>

<span class="c1"># Calcul du modèle</span>
<span class="n">t_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">v_mod</span> <span class="o">=</span> <span class="n">modquad</span><span class="p">(</span><span class="n">t_mod</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="c1"># Calcul de la somme S</span>
<span class="n">Si</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_exp</span> <span class="o">-</span> <span class="n">v_mod</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Si</span><span class="p">)</span>

<span class="c1"># Représentation graphique du modèle et des données</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="s1">&#39;+k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;données expérimentales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_mod</span><span class="p">,</span> <span class="n">v_mod</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;modèle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;S = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v0 = -0.71 m.s**-1
g = 12.80 m.s**-2
c = 1.93 m.s**-3
</pre></div>
</div>
<img alt="../../../_images/02-ajustement-modele_25_1.png" src="../../../_images/02-ajustement-modele_25_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="erreurs-de-mesures">
<h2>Erreurs de mesures<a class="headerlink" href="#erreurs-de-mesures" title="Permalink to this headline">¶</a></h2>
<p>Vous savez pour avoir déjà fait des expériences de physique en Travaux Pratiques, que l’on attache toujours une erreur estimée aux mesures expérimentales. Il est possible avec la fonction <code class="docutils literal notranslate"><span class="pre">errorbar()</span></code> de matplotlib d’afficher à la fois les mesures et leur barre d’erreur.</p>
<p>Dans notre exemple, on suppose que chaque mesure a la même erreur de mesure qui est de <span class="math notranslate nohighlight">\(\pm 2\)</span> m.s <span class="math notranslate nohighlight">\(^{-1}\)</span>. On peut alors représenter les barres d’erreur avec l’option <code class="docutils literal notranslate"><span class="pre">yerr</span></code> (par défaut le 3ème argument) de la fonction <code class="docutils literal notranslate"><span class="pre">errorbar()</span></code>, qui est un tableau de même dimension que les données contenant les erreurs sur chaque point de mesure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># définition du tableau des erreurs de mesure</span>
<span class="n">erreurs</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">v_exp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># m/s</span>


<span class="c1"># Représentation graphique des données avec les barres d&#39;erreur</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">erreurs</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># Option du graphique</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/02-ajustement-modele_27_0.png" src="../../../_images/02-ajustement-modele_27_0.png" />
</div>
</div>
</div>
<div class="section" id="erreurs-sur-les-parametres-ajustes">
<h2>Erreurs sur les paramètres ajustés<a class="headerlink" href="#erreurs-sur-les-parametres-ajustes" title="Permalink to this headline">¶</a></h2>
<p>Nous ne rentrerons pas dans les détails, mais la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit()</span></code> permet d’estimer l’erreur sur les paramètres du modèle ajustés aux données grâce à la donnée des erreurs de mesure. Il faut alors spécifier les erreurs de mesure grâce à l’option <code class="docutils literal notranslate"><span class="pre">sigma</span></code> de la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit()</span></code>, avec le tableau contenant les erreurs <span class="math notranslate nohighlight">\(\sigma_{y_i}\)</span> sur chaque mesure.</p>
<p>La somme quadratique des écarts entre le modèle et les données du problème est alors pondérée par les incertitudes de mesure :</p>
<div class="math notranslate nohighlight">
\[
S = \sum_{i=0}^{N-1} \frac{(y_i - P(x_i))^2}{{\sigma_{y_i}}^2}
\]</div>
<p>Ainsi, les mesures avec une grande incertitude vont moins contribuer à la somme, et donc auront moins d’impact sur l’ajustement du modèle aux données.</p>
<p>On pourra remarquer qu’en plus du tableau contenant les paramètres ajustés, un deuxième tableau est retourné par la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit()</span></code>. Il s’agit de la matrice de covariance de ces paramètres (que l’on notera <code class="docutils literal notranslate"><span class="pre">pcov</span></code> dans le code ci-dessous). On peut extraire de la matrice de covariance l’incertitude sur chacun des paramètres, donnée par la racine carrée des éléments diagonaux : <code class="docutils literal notranslate"><span class="pre">perr</span> <span class="pre">=</span> <span class="pre">np.sqrt(np.diag(pcov))</span></code>.</p>
<p>Par exemple, estimons l’erreur sur les paramètres ajustés pour le modèle linéaire :</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ajustement du modèle linéaire</span>
<span class="n">solution</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">modlin</span><span class="p">,</span> <span class="n">t_exp</span><span class="p">,</span> <span class="n">v_exp</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">erreurs</span><span class="p">,</span> <span class="n">absolute_sigma</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Identification des paramètres du modèle</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">solution</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span>

<span class="c1"># Calcul de l&#39;incertitude sur les paramètres ajustés</span>
<span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>

<span class="c1"># Affichage</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v0 = </span><span class="si">%5.3f</span><span class="s1"> </span><span class="se">\u00B1</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> m/s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g = </span><span class="si">%5.3f</span><span class="s1"> </span><span class="se">\u00B1</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> m/s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">perr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v0 = -0.998 ± 1.128 m/s
g = 10.870 ± 1.907 m/s
</pre></div>
</div>
</div>
</div>
<div class="alert alert-warning">
<p><strong>Attention</strong></p>
<p>Par défaut la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> applique un facteur multiplicatif global sur les erreurs afin de normaliser la somme <span class="math notranslate nohighlight">\(S\)</span>, c’est-à-dire pour que <span class="math notranslate nohighlight">\(S=1\)</span>. Ainsi, par défaut, les erreurs n’ont pas un sens absolu mais seulement relatif entre elles. Afin d’obtenir l’erreur absolue, il faut mettre l’option <code class="docutils literal notranslate"><span class="pre">absolute_sigma</span> <span class="pre">=</span> <span class="pre">True</span></code> dans la fonction <code class="docutils literal notranslate"><span class="pre">curve_fit()</span></code>.</p>
</div></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./source/notebooks/04-ajustement-modele"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../03-suites-relations-recurrence/03-suite-graphique.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Représentation graphique d’une suite mathématique</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../05-derivation-integration/01-derivation-integration-cours.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dérivation et intégration numérique</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By P. Delva<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>